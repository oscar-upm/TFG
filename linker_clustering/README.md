# Linker clustering

This folder contains the code used to perform hierarchical clustering on the fusion models generated by RFdiffusion.

## Calculate RMSD between RFdiffusion models

`calculateRMSD.py` is a PyMOL script that calculates the RMSD distance between all pairs of RFdiffusion models.
For each linker set (D1K1 and D1K2), all RFdiffusion pdb files were loaded into a PyMOL session. Then `calculateRMSD.py` was run, generating an output file that contained a dictionary with the RMSD distance between all pairs of fusion models.

These output files were:
- `RMSD_D1K1.json`
- `RMSD_D1K2.json`

## Hierarchical clustering and prototype selection

The notebook `clusteringRMSD.ipynb` contains the code to perform hierarchical clustering on each linker set, using the precomputed RMSD as an structural distance measurement between linkers. It also contains the code to select the linker prototypes and plot a dendrogram to visualize the hierarchical clustering.

Using this notebook two output files were generated:
- `RMSD_D1K1_agglomerative_th1.5.json`
- `RMSD_D1K2_agglomerative_th2.0.json`

These files contain three lists:
- A list with the name of all fusion models.
- A list with their corresponding cluster number.
- A list with the selected prototypes.